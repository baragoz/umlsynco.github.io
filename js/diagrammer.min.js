var dm=function(){return{base:{},menu:{},ds:{},cs:{},hs:{},dm:{},ms:{ctx:{},ds:{}},at:{cs:{created:null,selected:null}}}}(window);window.dm=dm;dm.base=dm.base;dm.menu=dm.menu;dm.ds=dm.ds;dm.cs=dm.cs;dm.es=dm.es;dm.hs=dm.hs;dm.dm=dm.dm;dm.ms=dm.ms;dm.ms.ctx=dm.ms.ctx;dm.at=dm.at;
(function(d,e,f){e.base.convert=function(a){var c={"<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;","#":"&#035;"};return a.replace(/[<>'"#]/g,function(a){return c[a]})};e.base.diagram=function(a,c,b){var j=a.split("."),l="dm."+a;namespace=j[0];a=j[1];b||(b=c,c=e.base.DiagramElement);e=e||{};e[namespace]=e[namespace]||{};e[namespace][a]=function(b,c){if(arguments.length){b=b||{};b.type==f&&(b.type=a);this._createDiagram(b,c)}};var j=new c,g=d.extend(!0,{},j.options);j.options=g;e[namespace][a].prototype=
d.extend(!0,{},j,{namespace:namespace,diagramName:a,diagramEventPrefix:e[namespace][a].prototype.diagramEventPrefix||a,diagramBaseClass:l,inherited:c.prototype.diagramBaseClass},b)};e.base.DiagramElement=function(a,c){arguments.length&&this._createDiagram(a,c)};e.base.DiagramElement.prototype={options:{editable:!0,nameTemplate:"base"},diagramBaseClass:"dm.base.DiagramElement",_createDiagram:function(a,c){this.options=d.extend(!0,{},this.options,a);this.parrent=c;this.euid=this.options.type+e.ds.diagram.ec;
this.options.name==f&&(this.options.name=this.options.nameTemplate+e.ds.diagram.ec);e.ds.diagram.ec++;this._create();(this.element=d(this.element))?(d(this.element).data(this.euid,this),this._baseinit(),d(this.element).bind("remove."+this.euid,this,function(a){a.data.destroy()}),this._init()):alert("Please, declare method _create() for diagram element "+this.euid)},getDescription:function(a,c){var b=!(a||c),j=Object.getPrototypeOf(this),l="{",d="";this._update();for(var h in this.options)if(this.options[h]!=
f)if(j.options[h]!=f){if(j.options[h]!=this.options[h]||"type"==h)l+=d+'"'+h+'":"'+this.options[h]+'"',d=",\n"}else{var e=this.options[h];if(e instanceof Array){var m="",l=l+(d+'"'+h+'":['),d=",",n;for(n in e)if(b||e[n].option(a)==c)l=e[n]&&e[n].getDescription?l+(m+e[n].getDescription()):l+(m+'"'+e[n]+'"'),m=",";l+="]\n"}else"object"!=typeof e&&(l+=d+'"'+h+'":"'+e+'"',d=",\n")}return l+"}"},_update:function(){d.log("_update")},_create:function(){d.log("_create")},_init:function(){d.log("_init")},
_baseinit:function(){d.log("_baseinit")},_destroy:function(){d.log("_destroy")},destroy:function(){this._destroy();this.element.unbind("."+this.euid).removeData(this.euid)},option:function(a,c){var b=a;if(0===arguments.length)return d.extend({},this.options);if("string"===typeof a){if(c===f)return this.options[a];b={};b[a]=c}this._setOptions(b);return this},_setOptions:function(a){for(var c in a)this._setOption(c,a[c])},_setOption:function(a,c){this.options[a]=c}};e.base.diagram("ds.diagram",{options:{nameTemplate:"diagram",
type2:"diagram",editable:!0},_create:function(){this.options.multicanvas?(this.canvasEuid=this.euid+"_Canvas",this.element=d(this.parrent).append('<div id="'+this.euid+'" class="us-diagram" width="100%" height="100%">          <canvas id="'+this.euid+'_Canvas" class="us-canvas" width='+this.options.width+"px height="+this.options.height+'px>          <p>Unfortunately your browser doesn\'t support canvas.</p></canvas>          <div class="us-canvas-bg" style="width:100%;height:100%;">          </div></div>')):
(this.element=d(this.parrent).append('<div id="'+this.euid+'" class="us-diagram" width="100%" height="100%">          <div class="us-canvas-bg" style="width:100%;height:100%;">          </div></div>'),this.canvasEuid="SingleCanvas");this.canvas=window.document.getElementById(this.canvasEuid);this.max_zindex=100;var a=this;d("#"+this.euid+".us-diagram").scroll(function(){a.draw()});var c=this;d("#"+this.euid).dblclick(function(a){a.preventDefault();d.log("DBL CLICK");a.stopPropagation()}).click(function(a){d.log("clicked");
c._setWidgetsOption("selected",false);d("#"+c.euid+" .us-references").hide();c.draw();a.stopPropagation()});this.connectors=[];this.elements=[];this.removedConnectors=[];this.removedElements=[];for(var b in this.options.elements)this.Element(this.options.elements[b].type,this.options.elements[b]);for(b in this.options.connectors)this.options.connectors[b].stored=!0,this.Connector(this.options.connectors[b].type,this.options.connectors[b]);e.dm.loader.OnLoadComplete(function(){for(var a in c.elements){var b=
c.elements[a].options.dropped;if(b){c.elements[a]._dropped={};for(var f in b)for(var d in c.elements)if(c.elements[d].options.id==b[f]){var e=c.elements[d].euid;c.elements[a]._dropped[e]=e;break}}}})},_init:function(){},_destroy:function(){if(this.onDestroyObserver)this.onDestroyObserver()},onDestroy:function(a){this.onDestroyObserver=a},Element:function(a,c,b){e.ds.diagram.ec++;var c=c||{},j=this;j.max_zindex++;c["z-index"]=j.max_zindex;c.ctx_menu=c.ctx_menu||"default";e.dm.loader.Element(a,c,this,
function(a){a!=f&&(j.elements[a.euid]=a);b&&b(a)});return c.euid},_setWidgetsOption:function(a,c){if("selected"==a){this.multipleSelection=c;for(var b in this.elements)this.elements[b]._setOption(a,c);for(b in this.connectors)this.connectors[b]._setOption(a,c);this.selectedConnector=this.selectedElement=f}else if("z-index"==a){var j=this.max_zindex,l=f,g=f,e=f;for(b in this.elements){var k=this.elements[b].option(a);this.elements[b].option("selected")?(l=l==f||k<l?k:l,g=g==f||k>g?k:g):e=e==f||k<e?
k:e}if(e==f||l==f)return;d.log("Min Z-INDEX: "+l);k="front"==c?!0:!1;for(b in this.elements)if(this.elements[b].option("selected")){if(k){var m=this.elements[b].option(a)+this.max_zindex-l+1;d.log("new Z-INDEX: "+m+" D: "+this.elements[b].option(a));this.elements[b]._setOption(a,m);m>j&&(j=m)}}else k||(m=this.elements[b].option(a)-e+g+1,d.log("new2 Z-INDEX: "+m+" D: "+this.elements[b].option(a)),this.elements[b]._setOption(a,m),m>j&&(j=m));this.max_zindex=j+1}else{for(b in this.elements)this.elements[b].option("selected")&&
this.elements[b]._setOption(a,c);for(b in this.connectors)this.connectors[b].option("selected")}this.draw()},Connector:function(a,c,b){var j=this;e.dm.loader.Connector(a,c,this,function(a){a!=f&&(j.connectors[a.euid]=a,"ConnectionHelper"!=a.options.toId&&d.log("REPORT: "+a.options.toId+"   FROM : "+a.options.fromId),j.draw(),b&&b(a))})},draw:function(){if(this.canvas){var a=this.canvas.getContext("2d");a.fillStyle="#EEEEEE";a.clearRect(0,0,this.canvas.width,this.canvas.height);if(0<Object.keys(this.connectors).length){for(var c in this.connectors)(a.lineWidth=
1,this.connectors[c].options.linewidth!=f&&(a.lineWidth=this.connectors[c].options.linewidth),this.connectors[c].options.selected)?(a.lineWidth+=2,this.connectors[c].redraw(a,"#43EC28"),a.lineWidth-=2,this.connectors[c].redraw(a)):this.selectedconntector==this.connectors[c]?this.connectors[c].redraw(a,"#43EC28"):this.connectors[c].options.color?this.connectors[c].redraw(a,this.connectors[c].options.color):this.connectors[c].redraw(a);a.lineWidth=1}}},isPointOnLine:function(a,c){if(0<Object.keys(this.connectors).length){if(!0==
this.transformStarted)return this.selectedconntector.TransformTo(a,c),this.draw(),!0;for(var b in this.connectors)if(this.connectors[b].isPointOnLine(a,c))return this.connectors[b]!=this.selectedconntector&&(this.selectedconntector=this.connectors[b],this.draw()),!0}this.selectedconntector!=f&&(this.selectedconntector._showMenu!=f&&this.selectedconntector._showMenu(a,c,!1),this.selectedconntector=f,e.at.cs.mouseover=null,this.draw());return!1}});e.base.diagram("es.element",{options:{drop:!1,nameTemplate:"Element",
width:140,height:200,left:140,top:200,selected:!1,area:"none",ctx_menu:"default",editable:!0},_create:function(){alert("Could not create virtual element !!!")},_update:function(){var a=d("#"+this.euid+"_Border").position();this.options.pageX=a.left;this.options.pageY=a.top;this.options.left=a.left;this.options.top=a.top;this.options.width=d("#"+this.euid+"_Border").width();this.options.height=d("#"+this.euid+"_Border").height();if(this._dropped){this.options.dropped=[];for(var c in this._dropped)this.parrent.elements[c]?
this.options.dropped.push(this.parrent.elements[c].options.id):alert("NOTE FOUND: "+c)}},_init:function(){this.options.height&&(d("#"+this.euid).css("width",this.options.width).css("height",this.options.height),d("#"+this.euid+"_Border").css("width",this.options.width));this.options.top&&d("#"+this.euid).css("top",this.options.top)},_baseinit:function(){var a="";this.options.pageX!=f&&this.options.pageY!=f&&(a=" style='top:"+this.options.pageY+"px;left:"+this.options.pageX+"px;' ");d(this.element).wrap('<div id="'+
this.euid+'_Border"'+a+' class="us-element-border"></div>');this.highlighted=!1;this.refN=0;this.options.references=this.options.references||[];var a=this.options.subdiagrams||this.options.references||{},c;c="<div class='us-references us-list'><ul class='context-menu-3'><li id='reference-new'><a>new reference</a></li></ul></div>";d("#"+this.euid+"_Border").css({position:"absolute"}).css("top",this.options.pageY).css("left",this.options.pageX);d("#"+this.euid+"_Border .ui-resizable-handle").css({visibility:"hidden"});
d("#"+this.euid).click(this,function(){d("#"+element.parrent.euid+" .us-references").hide()}).mouseenter(this,function(a){a=a.data;if(!a.options.selected&&!a.highlighted){a.highlighted=!0;var b=d("#"+this.id+"_Border").css({"border-width":"3px"}),c=b.css("border-left-width");b.css({left:"-="+c,top:"-="+c})}!a.parrent.options.editable&&(a.options.subdiagrams||0!=a.options.references.length)&&d("#"+this.id+"_REF").css({visibility:"visible"})}).mouseleave(this,function(a){a=a.data;if(!a.options.selected&&
a.highlighted){var b=d("#"+this.id+"_Border"),c=b.css("border-left-width");b.css({"border-width":"0px"}).css({left:"+="+c,top:"+="+c});a.highlighted=!1}d("#"+this.id+"_REF").css({visibility:"hidden"})}).append("<img id='"+this.euid+"_REF' title='REFERENCE' src='./images/reference.png' class='us-element-ref' style='z-index:99999;visibility:hidden;'></img>").parent().append(c);for(var b in a)this.addReference({text:a[b]},!0);d("#"+this.euid+"_Border .us-references").hide().click(function(a){a.stopPropagation()});
d("img#"+this.euid+"_REF").attr("title",this.options.subdiagrams).click(this,function(a){var b=a.data,c="none"==d("#"+b.euid+" .us-references").css("display");d("#"+b.parrent.euid+" .us-references").hide();c||(c=d(this).position(),d("#"+b.euid+"_Border .us-references").show().css({top:c.top+20,left:c.left}));a.stopPropagation()});this.options.color&&this._setOption("color",this.options.color);this.options.borderwidth&&this._setOption("borderwidth",this.options.borderwidth);this.options["font-family"]&&
this._setOption("font-family",this.options["font-family"]);this.options["z-index"]&&d("#"+this.euid+"_Border").css("z-index",this.options["z-index"])},addReference:function(a,c){var b;b="reference-"+this.refN;++this.refN;c||this.options.references.push(a.text);var j=a.idx==f?this.refN:a.idx;b=d("<li id='reference'><a id='"+b+"' class='editablefield reference'>"+a.text+"</a><a class='ui-corner-all'><span class='ui-test ui-icon ui-icon-close' style='float:right;'></span></a></li>");j=d("#"+this.euid+
"_Border .us-references ul li:eq("+j+")");b=1==j.length?b.insertAfter(j):b.appendTo("#"+this.euid+"_Border div.us-references ul");b=b.children("A.reference").bind("click",this,function(a){var b=a.data;b.parrent.options.editable||e.dm.fw.loadContent2(b.parrent.parrent,d(this).text());a.stopPropagation()})},_setOption:function(a,c){var b=this.options[a];if(!(this._setOption2!=f&&this._setOption2(a,c)))if("font-color"==a)d("#"+this.euid+"_Border.us-element-border a").css("color",c);else if("left"==a)d("#"+
this.euid+"_Border").css(a,c);else if("top"==a)d("#"+this.euid+"_Border").css(a,c);else if("color"==a)d("#"+this.euid).css("background-color",c||"");else if("borderwidth"==a)d("#"+this.euid).css("border-width",c||"");else if("width"==a)d("#"+this.euid+"_Border").css("width",c);else if("height"==a){if(d("#"+this.euid+"_Border").css("height",c),b&&c!=b){var b=parseInt(c)-parseInt(b),j=0<b?"+="+b:"-="+Math.abs(b);0!=b&&d("#"+this.euid+"_Border .us-element-resizable-area").css("height",j)}}else"font-family"==
a?d("#"+this.euid).css(a,c||""):"selected"==a?c?(d("#"+this.euid+"_Border .ui-resizable-handle").css({visibility:"visible"}),this.highlighted||(b=d("#"+this.euid+"_Border").css({"border-width":"3px"}),j=b.css("border-left-width"),b.css({left:"-="+j,top:"-="+j}),this.highlighted=!0)):(d("#"+this.euid+"_Border .ui-resizable-handle").css({visibility:"hidden"}),this.highlighted&&(b=d("#"+this.euid+"_Border"),j=b.css("border-left-width"),b.css({"border-width":"0px"}).css({left:"+="+j,top:"+="+j})),this.highlighted=
!1):"z-index"==a&&d("#"+this.euid+"_Border ").css(a,c||"");this.options[a]=c}});e.ds.diagram=e.ds.diagram||{};e.ds.diagram.ec=0;e.base.diagram("cs.connector",{options:{selected:!1,nameTemplate:"Connector",ctx_menu:"connector"},addLabel:function(a){var c=this,b=a.lid!=f?a.lid:this.euid+"_l"+this.label_count;a.lid==f&&++this.label_count;d("<div id='"+b+"' class='editablefield' style=\"position:absolute;z-index:99999;background-color:white;\">"+a.text+"</div>").appendTo("#"+this.parrent.euid).css("left",
a.left).css("top",a.top).mouseenter(function(){c.options.selected=!0;c.parrent.draw();for(var a in c.labels)d(c.labels[a]).addClass("us-connector-hover")}).mouseleave(function(){c.options.selected=!1;c.parrent.draw();for(var a in c.labels)d(c.labels[a]).removeClass("us-connector-hover")})},_setOption:function(a,c){if(c==f)delete this.options[a];else if("epoints"==a)for(var b in c)this.epoints[b][0]=c[b][0],this.epoints[b][1]=c[b][1];else if("labels"==a)for(b in c)this.labels[b].css({left:c[b][0],
top:c[b][1]});else this.options[a]=c},_create:function(){this.epoints=[];var a=this;this.options.epoints!=f&&d.each(this.options.epoints,function(b,c){a.epoints[b]=[];a.epoints[b][0]=parseInt(c[0]);a.epoints[b][1]=parseInt(c[1])});this.label_count=0;this.cleanOnNextTransform=!1;e.at.cs.created={euid:this.euid,from:this.options.fromId,to:this.options.toId};if(this.options.stored){for(var c in this.parrent.elements)if(this.parrent.elements[c].options.id==this.options.fromId&&(this.from=this.parrent.elements[c].euid),
this.parrent.elements[c].options.id==this.options.toId)this.toId=this.parrent.elements[c].euid;if(this.options.epoints)for(c in e.debug=e.debug||{},e.debug[this.euid]=this.options.epoints,this.epoints=[],this.options.epoints)this.epoints[c]={},this.epoints[c][0]=parseInt(this.options.epoints[c][0],10),this.epoints[c][1]=parseInt(this.options.epoints[c][1],10);this.options.fromId=this.from;this.options.toId=this.toId}else this.from=this.options.fromId,this.toId=this.options.toId;this.labels=[];for(c in this.options.labels){var b=
this.options.labels[c];this.addLabel({text:b.name,left:parseInt(b.x),top:parseInt(b.y)})}},_init:function(){},_baseinit:function(){},drawSelected:function(a,c,b){a.beginPath();a.fillStyle=b;a.strokeStyle=b;a.moveTo(c[0][0],c[0][1]);for(b=1;b<c.length;++b)a.lineTo(c[b][0],c[b][1]);a.stroke();a.closePath()},draw:function(){},redraw:function(a,c){var b=c||"rgba(0,0,0,1)";if(a!=f){this.points=this._getConnectionPoints(this.from,this.toId,this.epoints);this.gip=[];for(var j=0;j<this.points.length-1;++j){var d=
this.points[j][1]-this.points[j+1][1],e=this.points[j][0]-this.points[j+1][0];this.gip[j]=Math.sqrt(e*e+d*d)}this.draw(a,this.points,b)}},_getRValue:function(a,c,b){var f=c-a;return 0<f?f>b?a+b:c:a},isPointOnLine:function(a,c){if(this.points==f)return!1;for(var b=0;b<this.epoints.length;++b)if(this.epoints[b][0]-12<a&&this.epoints[b][0]+12>a&&this.epoints[b][1]-12<c&&this.epoints[b][1]+12>c)return e.at.cs.mouseover={euid:this.euid,idx:b},!0;for(b=0;b<this.points.length-1;++b){var j=a-this.points[b][0],
d=c-this.points[b][1],g=this.points[b+1][0]-a,h=this.points[b+1][1]-c,j=Math.sqrt(j*j+d*d),g=Math.sqrt(g*g+h*h);if(0.2>j+g-this.gip[b])return e.at.cs.mouseover={euid:this.euid},!0}return!1},canRemovePoint:function(a,c,b){if(a==f||c==f)return!1;var j=a[0]-c[0],d=a[1]-c[1],e=a[0]-b[0],h=a[1]-b[1],a=c[0]-b[0],c=c[1]-b[1],e=Math.sqrt(e*e+h*h),a=Math.sqrt(a*a+c*c),j=Math.sqrt(j*j+d*d);return 0.5>e+a-j?!0:!1},_getConnectionPoints:function(a,c,b){var j=d("#"+a).position(),e=d("#"+c).position();if(null!=
e){var g=d("#"+a+"_Border").position(),h=d("#"+c+"_Border").position(),k=d("#"+this.parrent.euid).scrollTop(),m=d("#"+this.parrent.euid).scrollLeft();if(b==f||0==b.length)var n=this._getRValue(j.left+g.left,e.left+h.left,d("#"+a).width()),o=this._getRValue(j.top+g.top,e.top+h.top,d("#"+a).height()),a=this._getRValue(e.left+h.left,j.left+g.left,d("#"+c).width()),c=this._getRValue(e.top+h.top,j.top+g.top,d("#"+c).height()),j=[[n+m,o+k],[a+m,c+k]];else{var k=d("#"+this.parrent.euid).scrollTop(),m=d("#"+
this.parrent.euid).scrollLeft(),p=b.length-1,n=this._getRValue(j.left+g.left,b[0][0]-m,d("#"+a).width())+m,o=this._getRValue(j.top+g.top,b[0][1]-k,d("#"+a).height())+k,a=this._getRValue(e.left+h.left,b[p][0]-m,d("#"+c).width())+m,c=this._getRValue(e.top+h.top,b[p][1]-k,d("#"+c).height())+k,m=k=0,j=[];j[0]=[n,o];for(n=1;n<=b.length;++n)j[n]=[b[n-1][0],b[n-1][1]],j[n][0]-=m,j[n][1]-=k;j[b.length+1]=[a,c]}return j}}})})(jQuery,dm);
(function(d,e,f){e.base.diagram("es.class",e.es.element,{options:{nameTemplate:"Class",width:"150px",height:"auto"},_getAux:function(a){var c=[];c.Class="";c.Interface="interface";c.Enumeration="enum";c.Primitive="primitive";c.ORM="ORM";c.ORMComponent="ORMComponent";c.Template=" ";c[f]="";return c[a]||a},addOperation:function(a){if("Enumeration"!=this.options.aux){var c=a.idx==f?this.opN:a.idx,b;b="operation-"+this.opN;++this.opN;this.options.operations.push(a.text);a=d('<li id="operation"><a id="'+
b+'" class="editablefield operation" >'+a.text+"</a></li>");c=d("#"+this.euid+" .us-class-operations .us-sortable li:eq("+c+")");1==c.length?a.insertAfter(c):a.appendTo("#"+this.euid+" .us-class-operations .us-sortable");a=a.children("a");c=a.height();e.base.editable(this,a,!0);a=d("#"+this.euid+" .us-class-operations .us-sortable").sortable("refresh").height();b=d("#"+this.euid+" .us-class-operations").height();a>b&&(d("#"+this.euid+"_Border").height(),d("#"+this.euid+"_Border").height("+="+c),d("#"+
this.euid+" .us-class-operations").height("+="+c),a=d("#"+this.euid+"_Border").height(),this.options.height=a,this.options.height_o+=c)}},addAttribute:function(a){if("Interface"!=this.options.aux){var c;c="attribute-"+this.atrN;++this.atrN;var b=a.idx==f?this.opN:a.idx,a=d('<li id="attribute"><a id="'+c+'" class="editablefield attribute" >'+a.text+"</a></li>"),b=d("#"+this.euid+" .us-class-attributes .us-sortable li:eq("+b+")"),a=1==b.length?a.insertAfter(b):a.appendTo("#"+this.euid+" .us-class-attributes .us-sortable"),
b=a.height(),a=d("#"+this.euid+" .us-class-attributes .us-sortable").sortable("refresh").height();c=d("#"+this.euid+" .us-class-attributes").height();a>c&&(d("#"+this.euid+"_Border .us-class-attributes").height(),d("#"+this.euid+"_Border").height("+="+b),d("#"+this.euid+" .us-class-attributes").height("+="+b),b=d("#"+this.euid+"_Border .us-class-attributes").height(),this.options.height_a=b,this.options.height=d("#"+this.euid+"_Border").height())}},_create:function(){var a="",c="";this.opN=this.atrN=
0;this.options.operations=this.options.operations||[];this.options.attributes=this.options.attributes||[];this.options.aux&&""!=this.options.aux&&(a=this._getAux(this.options.aux),a!=f&&(""!=a&&" "!=a)&&(c="&lt&lt "+a+" &gt&gt"),a="Template"!=this.options.aux?"":"<div id='template' class='editablefield us-class-template'>"+(this.options.template||"T")+"</div>");var b="",j="",e;for(e in this.options.operations)b+='<li id="operation"><a id="operation-'+this.atrN+'" class="editablefield operation">'+
this.options.operations[e]+"</a></li>",this.atrN++;for(e in this.options.attributes)j+='<li id="attribute"><a id="attribute-'+this.opN+'" class="editablefield attribute">'+this.options.attributes[e]+"</a></li>",this.opN++;this.innerHtmlClassInfo='        <div id="'+this.euid+'" class="us-class grElement">'+a+'        <div class="us-class-header">        <a id="name" class="editablefield us-class-name">'+this.options.name+'</a><br>        <a id="aux" class="us-class-aux">'+c+'</a>        </div>        <div class="us-class-attributes"><ul class="us-sortable">'+
j+'</ul></div>        <div class="us-class-operations us-element-resizable-area"><ul class="us-sortable">'+b+"</ul></div>        </div>      ";d("#"+this.parrent.euid).append(this.innerHtmlClassInfo);this.element=d("#"+this.euid)},_init:function(){this._setOptions(this.options);this.attributes=[];this.operations=[]},_setOption2:function(a,c){if("height_o"==a)return d("#"+this.euid+"_Border .us-class-operations").css("height",c),!0;if("height_a"==a){var b=this.options[a];d("#"+this.euid+"_Border .us-class-attributes").css("height",
c);b=parseInt(c)-parseInt(b);if(0!=b){var f=0<b?"+="+b:"-="+Math.abs(b);d("#"+this.euid+"_Border").css("height",f);this.options.height+=b}return!0}"editable"==a&&d("#"+this.euid+" .us-sortable").sortable({disabled:!0==c?!1:!0});return!1},ec:0})})(jQuery,dm);
(function(d,e,f){e.dm.loader=e.dm.loader||null;e.base.loader=function(a){e.dm.loader||(e.dm.loader=new function(){this.working=!1;return{getUrl:function(){return a},_addToLoadQueue:function(a){var b=e.dm.loader;b._loadQueue||(b.working=!1,b._loadQueue=[]);b._loadQueue.push(a);b._process(!1)},_process:function(c){var b=null,f=e.dm.loader;if(!f.working){if(c&&0<f._loadQueue.length||1==f._loadQueue.length&&!f.working)f.working=!0,b=f._loadQueue.shift();if(b){var l=b.callback,g=b.data;b.precondition()?
d.ajax({url:a+b.url,dataType:"script",success:function(){l(g);f.working=!1;f._process(!0)},error:function(){alert("Failed to load: "+a+b.url);f.working=!1;f._process(!0)}}):(l(g),f.working=!1,f._process(!0))}else f.working=!1}},OnLoadComplete:function(a,b){this._addToLoadQueue({url:"",precondition:function(){return!1},callback:function(b){a&&a(b)},data:b})},Diagram:function(a,b,j,l,g){(e.ds==f||e.ds.diagram==f)&&this._addToLoadQueue({url:"./dm/ds/diagram.js",precondition:function(){return!0},callback:function(){},
data:null});var h={},k=j||{};k.type=a;k.base_type=b;h.options=j;h.diagram=a;h.type=b;h.parrent=l;this._addToLoadQueue({url:"/dm/ds/"+b+".js",precondition:function(){return e.ds==f||e.ds[b]==f?!0:!1},callback:function(a){a=new e.ds[a.type](j,l);d.log("NAME: "+l);g&&g(a);return a},data:h})},LoadElement:function(a){e.es==f?alert("You should create diagram instance first !!!"):e.es[a]==f&&this._addToLoadQueue({url:"/dm/es/"+a+".js",precondition:function(){return e.es[a]==f?!0:!1},callback:function(){}})},
Element:function(a,b,d,l){if(e.es==f)alert("You should create diagram instance first !!!");else{var g={};g.options=b;g.type=a;g.diagram=d;this._addToLoadQueue({url:"/dm/es/"+a+".js",precondition:function(){return e.es[a]==f?!0:!1},callback:function(a){a=new e.es[a.type](a.options,a.diagram);l&&l(a)},data:g})}},Connector:function(a,b,d,l){if(e.cs==f)alert("You should create diagram instance first !!!");else{var g={};g.options=b;g.type=a;g.diagram=d;this._addToLoadQueue({url:"./dm/cs/"+a+".js",precondition:function(){return e.cs[a]==
f?!0:!1},callback:function(a){a=new e.cs[a.type](a.options,a.diagram);l!=f&&l(a)},data:g})}}}},e.dm.loader.url=a,e.dm.loader.working=!1);return e.dm.loader};e.base.loader=e.base.loader})(jQuery,dm);
(function(d,e){e.base.diagram("cs.aggregation",e.cs.connector,{draw:function(f,a,c){if(!(null==a||2>a.length)){var b=a.length-1,d=a[b][0]-a[b-1][0],e=a[b][1]-a[b-1][1],g=Math.sqrt(d*d+e*e);if(!(10>g)){var h=e/g,k=d/g,m=a[b][0]-Math.sqrt(75)*k,n=a[b][1]-Math.sqrt(75)*h,d=a[b][0]-Math.sqrt(300)*k,g=a[b][1]-Math.sqrt(300)*h,e=m+10*h/2,o=n-10*k/2,h=m-10*h/2,k=n+10*k/2;f.beginPath();f.fillStyle=c;f.strokeStyle=c;f.moveTo(a[0][0],a[0][1]);for(c=1;c<b;++c)f.lineTo(a[c][0],a[c][1]);f.moveTo(a[b-1][0],a[b-
1][1]);f.lineTo(d,g);f.lineTo(e,o);f.lineTo(a[b][0],a[b][1]);f.lineTo(h,k);f.lineTo(d,g);f.stroke();f.closePath()}}}})})(jQuery,dm);
(function(d,e){e.base.diagram("cs.nested",e.cs.connector,{draw:function(f,a,c){if(!(null==a||2>a.length)){var b=a.length-1,d=a[b][0]-a[b-1][0],e=a[b][1]-a[b-1][1],g=Math.sqrt(d*d+e*e),e=e/g,h=d/g,d=a[b][0]-Math.sqrt(168.75)*h,k=a[b][1]-Math.sqrt(168.75)*e,m=a[b][0]-Math.sqrt(675)*h,n=a[b][1]-Math.sqrt(675)*e,o=d+12*e/2,p=k-12*h/2,q=d-12*e/2,r=k+12*h/2,s=a[b][0]-Math.sqrt(108)*h,t=a[b][1]-Math.sqrt(108)*e,h=a[b][0]-Math.sqrt(432)*h,e=a[b][1]-Math.sqrt(432)*e;f.beginPath();f.fillStyle=c;f.strokeStyle=
c;f.moveTo(a[0][0],a[0][1]);for(i=1;i<b;++i)f.lineTo(a[i][0],a[i][1]);15>g||(f.moveTo(a[b-1][0],a[b-1][1]),f.lineTo(m,n),f.stroke(),f.moveTo(d,k),f.arc(d,k,7.5,0,2*Math.PI,!0),f.moveTo(o,p),f.lineTo(q,r),f.moveTo(s,t),f.lineTo(h,e),f.stroke(),f.closePath())}}})})(jQuery,dm);
(function(d,e){e.base.diagram("cs.composition",e.cs.connector,{draw:function(f,a,c){if(!(null==a||2>a.length)){var b=a.length-1,d=a[b][0]-a[b-1][0],e=a[b][1]-a[b-1][1],g=Math.sqrt(d*d+e*e);if(!(10>g)){var e=e/g,h=d/g,k=a[b][0]-Math.sqrt(75)*h,m=a[b][1]-Math.sqrt(75)*e,d=a[b][0]-Math.sqrt(300)*h,g=a[b][1]-Math.sqrt(300)*e,n=k+10*e/2,o=m-10*h/2,e=k-10*e/2,h=m+10*h/2;f.beginPath();f.fillStyle=c;f.strokeStyle=c;f.moveTo(a[0][0],a[0][1]);for(i=1;i<b;++i)f.lineTo(a[i][0],a[i][1]);f.stroke();f.closePath();
f.beginPath();f.fillStyle=c;f.strokeStyle=c;f.moveTo(a[b-1][0],a[b-1][1]);f.lineTo(d,g);f.lineTo(n,o);f.lineTo(a[b][0],a[b][1]);f.lineTo(e,h);f.lineTo(d,g);f.fill();f.stroke();f.closePath()}}}})})(jQuery,dm);
(function(d,e){e.base.diagram("cs.dependency",e.cs.connector,{dashedLine:function(f,a,c){var b=f[0],f=f[1],d=a[0]-b,e=a[1]-f,a=Math.sqrt(d*d+e*e);if(!(10>a)){var e=e/a,g=d/a,d=5*g,h=5*e,g=3*g,e=3*e;for(i=0;i<a/8;++i)c.moveTo(b,f),c.lineTo(b+d,f+h),b+=g+d,f+=e+h}},draw:function(d,a,c){if(!(null==a||2>a.length)){var b=a.length-1,e=a[b][0],l=a[b][1],g=e-a[b-1][0],h=l-a[b-1][1],b=Math.sqrt(g*g+h*h),h=h/b,k=g/b,m=e-Math.sqrt(75)*k,n=l-Math.sqrt(75)*h;Math.sqrt(300);Math.sqrt(300);g=m+10*h/2;b=n-10*k/2;
h=m-10*h/2;k=n+10*k/2;d.beginPath();d.fillStyle=c;d.strokeStyle=c;for(c=0;c<a.length-1;++c)this.dashedLine(a[c],a[c+1],d);d.moveTo(g,b);d.lineTo(e,l);d.lineTo(h,k);d.stroke();d.closePath()}}})})(jQuery,dm);
(function(d,e){e.base.diagram("cs.realization",e.cs.connector,{dashedLine:function(d,a,c){var b=d[0],d=d[1],e=a[0]-b,l=a[1]-d,a=Math.sqrt(e*e+l*l);if(!(10>a)){var l=l/a,g=e/a,e=5*g,h=5*l,g=3*g,l=3*l;for(i=0;i<a/8;++i)c.moveTo(b,d),c.lineTo(b+e,d+h),b+=g+e,d+=l+h}},draw:function(d,a,c){if(!(null==a||2>a.length)){var b=a.length-1,e=a[b][0],l=a[b][1],g=e-a[b-1][0],h=l-a[b-1][1],b=Math.sqrt(g*g+h*h),k=h/b,m=g/b,g=e-Math.sqrt(75)*m,h=l-Math.sqrt(75)*k;Math.sqrt(300);Math.sqrt(300);var n=g+10*k/2,o=h-10*
m/2,k=g-10*k/2,m=h+10*m/2;d.beginPath();d.fillStyle=c;d.strokeStyle=c;for(c=0;c<a.length-1;++c)this.dashedLine(a[c],a[c+1],d);10>b||(d.moveTo(g,h),d.lineTo(n,o),d.lineTo(e,l),d.lineTo(k,m),d.lineTo(g,h));d.stroke();d.closePath()}}})})(jQuery,dm);(function(d,e){e.base.diagram("ds.base",e.ds.diagram,{diagramName:"BaseDiagram",diagramEventPrefix:"CD",options:{width:1300,height:700,type:"base"},_init:function(){}})})(jQuery,window.dm);
(function(d,e){e.base.diagram("cs.generalization",e.cs.connector,{draw:function(d,a,c){if(!(null==a||2>a.length)){var b=a.length-1,e=a[b][0],l=a[b-1][0],g=a[b][1],h=a[b-1][1],k=e-l,m=g-h,n=Math.sqrt(k*k+m*m);if(!(10>n)){var m=m/n,o=k/n,k=e-Math.sqrt(75)*o,n=g-Math.sqrt(75)*m;Math.sqrt(300);Math.sqrt(300);var p=k+10*m/2,q=n-10*o/2,m=k-10*m/2,o=n+10*o/2;d.beginPath();d.fillStyle=c;d.strokeStyle=c;d.moveTo(a[0][0],a[0][1]);for(i=1;i<b;++i)d.lineTo(a[i][0],a[i][1]);d.moveTo(l,h);d.lineTo(k,n);d.lineTo(p,
q);d.lineTo(e,g);d.lineTo(m,o);d.lineTo(k,n);d.stroke();d.closePath()}}}})})(jQuery,dm);
(function(d,e,f){e.base.diagram("es.package",e.es.element,{options:{nameTemplate:"Package",droppable:!0,acceptdrop:"package",height:"102px"},_update:function(){var a=d("#"+this.euid+"_Border").position();this.options.pageX=a.left;this.options.pageY=a.top;this.options.left=a.left;this.options.top=a.top;this.options.width=d("#"+this.euid+"_Border").width();this.options.height=d("#"+this.euid+"_Border").height();this.options.height_b=d("#"+this.euid+"_Border .us-package-body").height();if(this._dropped)for(i in this.options.dropped=
[],this._dropped)this.options.dropped.push(this.parrent.elements[this._dropped[i]].options.id)},_create:function(){this.innerHtml='<div id="'+this.euid+'" class="us-package">                                <div class="us-package-tab grElement"></div>            <div class="us-package-body grElement">'+(this.options.aux!=f?"<a>&lt&lt"+this.options.aux+"&gt&gt</a><br><b>":"")+'<a id="name" class="editablefield">'+this.options.name+"</a></div>                                </div>";d("#"+this.parrent.euid).append(this.innerHtml);
this.element=d("#"+this.euid)},_init:function(){this._setOptions(this.options)},_setOption2:function(a,c){return"color"==a?(d("#"+this.euid+" .us-package-tab").css("background-color",c),d("#"+this.euid+" .us-package-body").css("background-color",c),!0):"borderwidth"==a?(d("#"+this.euid+" .us-package-tab").css("border-width",c),d("#"+this.euid+" .us-package-body").css("border-width",c),!0):"font-family"==a?(d("#"+this.euid).css(a,c),!0):"z-index"==a?(d("#"+this.euid+"_Border ").css(a,c),!0):!1}})})(jQuery,
dm);
